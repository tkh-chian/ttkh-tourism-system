# TTKH旅游系统 - 人工验证测试指南

## 🚀 快速启动系统

### 第一步：启动后端服务器
1. 打开PowerShell或命令提示符
2. 执行以下命令：
```bash
cd ttkh-tourism-system
node backend/simple-server.js
```
3. 看到 "Server running on port 3001" 表示后端启动成功

### 第二步：启动前端服务器
1. 打开新的PowerShell窗口
2. 执行以下命令：
```bash
cd ttkh-tourism-system/frontend
npm start
```
3. 看到 "Compiled successfully!" 表示前端启动成功
4. 浏览器会自动打开 http://localhost:3000

## 🔑 设置管理员认证

### 在浏览器中设置认证信息
1. 在Chrome浏览器中访问 http://localhost:3000
2. 按 **F12** 打开开发者工具
3. 点击 **Console（控制台）** 标签
4. 复制粘贴以下命令并按回车：

```javascript
localStorage.setItem('token', 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiIwNDYxZGY1NC0zODQ2LTRmN2EtYmUyNC0yNjJmY2JlNGQzMGQiLCJpYXQiOjE3NTQ4OTQ3OTYsImV4cCI6MTc1NDk4MTE5Nn0.Ioi01mcqPIGQpfNvu_p82vU9c4mAJCNlEgmmoSu-4vM');
```

5. 再复制粘贴以下命令并按回车：

```javascript
localStorage.setItem('user', '{"id":"0461df54-3846-4f7a-be24-262fcbe4d30d","username":"admin@ttkh.com","email":"admin@ttkh.com","role":"admin","company_name":null,"contact_person":null,"phone":null,"status":"approved","created_at":"2025-08-10T17:25:28.000Z","updated_at":"2025-08-11T06:21:20.000Z"}');
```

6. 刷新页面（按F5）

## 🧪 核心功能测试

### 测试1：访问管理员商家管理页面
1. 在地址栏输入：`http://localhost:3000/admin/merchants`
2. **预期结果**：能看到商家列表，不再显示403错误
3. **验证点**：页面显示商家数据，有10个商家记录

### 测试2：访问管理员产品管理页面
1. 在地址栏输入：`http://localhost:3000/admin/products`
2. **预期结果**：能看到产品列表
3. **验证点**：页面显示产品数据，有1个产品记录

### 测试3：测试管理员登录功能
1. 清除浏览器存储：在控制台执行 `localStorage.clear()`
2. 访问登录页面：`http://localhost:3000/login`
3. 使用管理员账户登录：
   - 邮箱：`admin@ttkh.com`
   - 密码：`admin123`
4. **预期结果**：登录成功，跳转到管理员面板

### 测试4：验证API响应
1. 在控制台执行以下测试代码：

```javascript
// 测试管理员登录API
fetch('http://localhost:3001/api/auth/login', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({ email: 'admin@ttkh.com', password: 'admin123' })
})
.then(res => res.json())
.then(data => console.log('登录API测试:', data));

// 测试商家管理API
fetch('http://localhost:3001/api/admin/merchants', {
  headers: { 'Authorization': 'Bearer ' + localStorage.getItem('token') }
})
.then(res => res.json())
.then(data => console.log('商家API测试:', data));
```

## ✅ 验证成功标志

### 后端验证成功标志：
- [ ] 控制台显示 "Server running on port 3001"
- [ ] 控制台显示 "Connected to MySQL database"
- [ ] 没有数据库连接错误

### 前端验证成功标志：
- [ ] 浏览器显示 "Compiled successfully!"
- [ ] 能正常访问 http://localhost:3000
- [ ] 设置认证后能访问管理员页面

### 功能验证成功标志：
- [ ] 管理员商家页面显示10个商家
- [ ] 管理员产品页面显示1个产品
- [ ] 管理员登录功能正常
- [ ] API响应格式正确

## 🔧 常见问题解决

### 问题1：前端显示403错误
**解决方案**：确保已在浏览器控制台设置了认证信息

### 问题2：后端连接失败
**解决方案**：检查MySQL服务是否启动，确认数据库配置正确

### 问题3：前端编译失败
**解决方案**：在frontend目录执行 `npm install` 重新安装依赖

## 📊 测试完成确认

完成所有测试后，您应该能够：
1. ✅ 正常启动前后端服务器
2. ✅ 通过浏览器访问管理员功能
3. ✅ 查看商家和产品数据
4. ✅ 使用管理员账户登录

**如果以上功能都正常，说明系统已经100%修复完成，可以正常使用！**